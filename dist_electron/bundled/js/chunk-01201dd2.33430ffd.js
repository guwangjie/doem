(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01201dd2"],{"17d6":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("3a20"),r("c9db");function n(e,t,r,n,i,o,s){try{var l=e[o](s),a=l.value}catch(c){return void r(c)}l.done?t(a):Promise.resolve(a).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var s=e.apply(t,r);function l(e){n(s,i,o,l,a,"next",e)}function a(e){n(s,i,o,l,a,"throw",e)}l(void 0)}))}}},"3a20":function(e,t,r){var n=r("efd1"),i=r("3d8a"),o=r("3f8e");n||i(Object.prototype,"toString",o,{unsafe:!0})},"3f8e":function(e,t,r){"use strict";var n=r("efd1"),i=r("9552");e.exports=n?{}.toString:function(){return"[object "+i(this)+"]"}},"514e":function(e,t,r){},bf24:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container permission_src_edit"},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-col",{attrs:{xs:24,md:12}},[r("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.ruleForm,"label-position":"right","label-width":"150px"}},[r("el-form-item",{attrs:{label:"分组或者操作名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"分组或者操作名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"上级分组",prop:"parent_id"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.parent_id,callback:function(t){e.$set(e.ruleForm,"parent_id",t)},expression:"ruleForm.parent_id"}},e._l(e.options,(function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1)],1),r("el-form",{ref:"permissionForm",attrs:{rules:e.permissionrules,model:e.permissionForm,"label-position":"right","label-width":"150px"}},[r("el-form-item",{attrs:{label:"控制器",prop:"controller"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getPermissionActionOptions},model:{value:e.permissionForm.controller,callback:function(t){e.$set(e.permissionForm,"controller",t)},expression:"permissionForm.controller"}},e._l(e.controllerOptions,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"操作",prop:"action"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.permissionForm.action,callback:function(t){e.$set(e.permissionForm,"action",t)},expression:"permissionForm.action"}},e._l(e.actionOptions,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitPermissionForm("permissionForm")}}},[e._v("添加权限码")])],1)],1),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-table",{attrs:{data:e.ruleForm.permissionCode,border:""}},[r("el-table-column",{attrs:{prop:"controller_name",label:"控制器名"}}),r("el-table-column",{attrs:{prop:"action_name",label:"方法名"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),r("el-row",{staticClass:"block",attrs:{type:"flex",justify:"center"}},[r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)},i=[],o=(r("c1b0"),r("17d6")),s=r("f196"),l={name:"PermissionSrcEdit",data(){return{ruleForm:{title:"",parent_id:"",permissionCode:[],id:this.$route.query.id},permissionForm:{controller:"",action:""},options:[{title:"请选择",id:""},{title:"顶级分组",id:0}],controllerOptions:[{name:"请选择",value:""}],actionOptions:[{name:"请选择",value:""}],rules:{title:[{required:!0,message:"分组或者操作名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],parent_id:[{required:!0,message:"请选择上级分组",trigger:"change"}]},permissionrules:{controller:[{required:!0,message:"请选择控制器",trigger:"change"}],action:[{required:!0,message:"请选择操作",trigger:"change"}]}}},mounted(){var e=this;return Object(o["a"])((function*(){try{yield e.getOptions(),yield e.getPermissionControllerOptions(),yield e.getPermissionSrcDetail()}catch(t){}}))()},methods:{getOptions(){return Object(s["h"])({id:this.ruleForm.id}).then(e=>{this.options=this.options.concat(e.data)}).catch(()=>{})},getPermissionControllerOptions(){return Object(s["b"])().then(e=>{this.controllerOptions=this.controllerOptions.concat(e.data)}).catch(()=>{})},getPermissionSrcDetail(){return Object(s["e"])({id:this.ruleForm.id}).then(e=>{this.ruleForm=e.data}).catch(()=>{})},getPermissionActionOptions(e){if(""===e)return this.permissionForm.action="",void(this.actionOptions=[{name:"请选择",value:""}]);Object(s["a"])({controller:e}).then(e=>{this.actionOptions=[{name:"请选择",value:""}].concat(e.data),this.permissionForm.action=""}).catch(()=>{})},submitPermissionForm(e){this.$refs[e].validate(e=>{if(!e)return!1;try{this.ruleForm.permissionCode.forEach((e,t)=>{if(e.controller_name===this.permissionForm.controller&&e.action_name===this.permissionForm.action)throw this.$message({message:"该权限码已存在",type:"error"}),new Error("该权限码已存在")})}catch(t){return!1}this.ruleForm.permissionCode.push({controller_name:this.permissionForm.controller,action_name:this.permissionForm.action})})},handleDelete(e,t){this.ruleForm.permissionCode.splice(e,1)},submitForm(e){var t=this;this.$refs[e].validate(e=>{if(!e)return!1;Object(s["f"])(this.ruleForm).then(e=>{this.$message({message:"保存成功",type:"success",onClose:function(){t.$router.push("/permission/permission_src/permission_src_lst")}})}).catch(()=>{})})},resetForm(e){this.$refs[e].resetFields()}}},a=l,c=(r("e98a"),r("e90a")),u=Object(c["a"])(a,n,i,!1,null,"4663362b",null);t["default"]=u.exports},e98a:function(e,t,r){"use strict";var n=r("514e"),i=r.n(n);i.a},f196:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"h",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"d",(function(){return m}));var n=r("b775");function i(){return Object(n["a"])({url:"/permission/permissionControllerOptions",method:"get"})}function o(e){return Object(n["a"])({url:"/permission/permissionActionOptions",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/permission/permissionSrcOptions",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/permission/permissionSrcAdd",method:"post",data:e})}function a(e){return Object(n["a"])({url:"/permission/permissionSrcEdit",method:"post",data:e})}function c(){return Object(n["a"])({url:"/permission/permissionSrcLst",method:"get"})}function u(e){return Object(n["a"])({url:"/permission/permissionSrcDetail",method:"get",params:e})}function m(e){return Object(n["a"])({url:"/permission/permissionSrcDelete",method:"get",params:e})}}}]);
//# sourceMappingURL=chunk-01201dd2.33430ffd.js.map