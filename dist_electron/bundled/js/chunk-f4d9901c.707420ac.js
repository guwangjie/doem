(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f4d9901c"],{"561e":function(e,t,r){"use strict";var o=r("fe40"),i=r.n(o);i.a},6983:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container permission_src_add"},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-col",{attrs:{xs:24,md:12}},[r("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.ruleForm,"label-position":"right","label-width":"150px"}},[r("el-form-item",{attrs:{label:"分组或者操作名称",prop:"title"}},[r("el-input",{attrs:{placeholder:"分组或者操作名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"上级分组",prop:"parent_id"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.parent_id,callback:function(t){e.$set(e.ruleForm,"parent_id",t)},expression:"ruleForm.parent_id"}},e._l(e.options,(function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1)],1),r("el-form",{ref:"permissionForm",attrs:{rules:e.permissionrules,model:e.permissionForm,"label-position":"right","label-width":"150px"}},[r("el-form-item",{attrs:{label:"控制器",prop:"controller"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getPermissionActionOptions},model:{value:e.permissionForm.controller,callback:function(t){e.$set(e.permissionForm,"controller",t)},expression:"permissionForm.controller"}},e._l(e.controllerOptions,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"操作",prop:"action"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.permissionForm.action,callback:function(t){e.$set(e.permissionForm,"action",t)},expression:"permissionForm.action"}},e._l(e.actionOptions,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitPermissionForm("permissionForm")}}},[e._v("添加权限码")])],1)],1),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-table",{attrs:{data:e.ruleForm.permissionCode,border:""}},[r("el-table-column",{attrs:{prop:"controller_name",label:"控制器名"}}),r("el-table-column",{attrs:{prop:"action_name",label:"方法名"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),r("el-row",{staticClass:"block",attrs:{type:"flex",justify:"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)},i=[],n=(r("c1b0"),r("f196")),s={name:"PermissionSrcAdd",data(){return{ruleForm:{title:"",parent_id:"",permissionCode:[]},permissionForm:{controller:"",action:""},options:[{title:"请选择",id:""},{title:"顶级分组",id:0}],controllerOptions:[{name:"请选择",value:""}],actionOptions:[{name:"请选择",value:""}],rules:{title:[{required:!0,message:"分组或者操作名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],parent_id:[{required:!0,message:"请选择上级分组",trigger:"change"}]},permissionrules:{controller:[{required:!0,message:"请选择控制器",trigger:"change"}],action:[{required:!0,message:"请选择操作",trigger:"change"}]}}},mounted(){this.getOptions(),this.getPermissionControllerOptions()},methods:{getOptions(){Object(n["h"])().then(e=>{this.options=this.options.concat(e.data)}).catch(()=>{})},getPermissionControllerOptions(){Object(n["b"])().then(e=>{this.controllerOptions=this.controllerOptions.concat(e.data)}).catch(()=>{})},getPermissionActionOptions(e){if(""===e)return this.permissionForm.action="",void(this.actionOptions=[{name:"请选择",value:""}]);Object(n["a"])({controller:e}).then(e=>{this.actionOptions=[{name:"请选择",value:""}].concat(e.data),this.permissionForm.action=""}).catch(()=>{})},submitPermissionForm(e){this.$refs[e].validate(e=>{if(!e)return!1;try{this.ruleForm.permissionCode.forEach((e,t)=>{if(e.controller_name===this.permissionForm.controller&&e.action_name===this.permissionForm.action)throw this.$message({message:"该权限码已存在",type:"error"}),new Error("该权限码已存在")})}catch(t){return!1}this.ruleForm.permissionCode.push({controller_name:this.permissionForm.controller,action_name:this.permissionForm.action})})},handleDelete(e,t){this.ruleForm.permissionCode.splice(e,1)},submitForm(e){var t=this;this.$refs[e].validate(e=>{if(!e)return!1;Object(n["c"])(this.ruleForm).then(e=>{this.$message({message:"添加成功",type:"success",onClose:function(){t.$router.push("/permission/permission_src/permission_src_lst")}})}).catch(()=>{})})},resetForm(e){this.$refs[e].resetFields()}}},l=s,a=(r("561e"),r("e90a")),c=Object(a["a"])(l,o,i,!1,null,"110f08b6",null);t["default"]=c.exports},f196:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n})),r.d(t,"h",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return c})),r.d(t,"e",(function(){return m})),r.d(t,"d",(function(){return u}));var o=r("b775");function i(){return Object(o["a"])({url:"/permission/permissionControllerOptions",method:"get"})}function n(e){return Object(o["a"])({url:"/permission/permissionActionOptions",method:"get",params:e})}function s(e){return Object(o["a"])({url:"/permission/permissionSrcOptions",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/permission/permissionSrcAdd",method:"post",data:e})}function a(e){return Object(o["a"])({url:"/permission/permissionSrcEdit",method:"post",data:e})}function c(){return Object(o["a"])({url:"/permission/permissionSrcLst",method:"get"})}function m(e){return Object(o["a"])({url:"/permission/permissionSrcDetail",method:"get",params:e})}function u(e){return Object(o["a"])({url:"/permission/permissionSrcDelete",method:"get",params:e})}},fe40:function(e,t,r){}}]);
//# sourceMappingURL=chunk-f4d9901c.707420ac.js.map